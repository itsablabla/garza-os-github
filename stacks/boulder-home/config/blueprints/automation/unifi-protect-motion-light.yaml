# UniFi Protect Motion-Activated Light
# Triggers lights when camera detects motion, with sunset condition
blueprint:
  name: UniFi Protect Motion Light
  description: Turn on light when UniFi Protect camera detects motion (after sunset)
  domain: automation
  input:
    motion_sensor:
      name: Motion Sensor
      description: The UniFi Protect camera motion sensor
      selector:
        entity:
          domain: binary_sensor
          device_class: motion
    target_light:
      name: Light
      description: The light to turn on
      selector:
        entity:
          domain: light
    delay_minutes:
      name: Delay
      description: Minutes to keep light on
      default: 5
      selector:
        number:
          min: 1
          max: 30
          unit_of_measurement: minutes

trigger:
  - platform: state
    entity_id: !input motion_sensor
    to: "on"

condition:
  - condition: sun
    after: sunset

action:
  - service: light.turn_on
    target:
      entity_id: !input target_light
  - delay:
      minutes: !input delay_minutes
  - service: light.turn_off
    target:
      entity_id: !input target_light
